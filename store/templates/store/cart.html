{% extends 'base.html' %}

{% block head %}
<title>Panier de {{ user }}}</title>
{% endblock %}

{% block content %}
<p>Votre panier - {{ user }}</p>

<!--
Form set factory
-->


<form method="post">
    {% csrf_token %}
    {{ forms.management_form }}
    {% for form in forms %}

<div>
    <table class="table">

        <p>{{ form.instance.ticket.artist.name }} -- {{ form.instance.ticket.city.name }}</p>
        <p>{{ form.instance.ticket.price }} € / ticket</p>
        <h5>{{ form.instance.ticket.stock }} tickets restants en stock</h5>
        {{ form.as_p }}


    {% if form.errors %}
{% for message in form.errors.values %}
    <h3 style="color: red;">{{ message }}</h3>

    </table>
    </div>
    {% endfor %}
{% endif %}

{% endfor %}

    <button type="submit" class="btn btn-primary">Mettre à jour les quantités</button>
</form>





<h2>Montant du panier : {{ total }} €</h2>



<form action="{% url 'store:create-checkout-session' %}" method="POST">
    {% csrf_token %}
<button type="submit" class="btn btn-primary">Procéder au paiement</button>
    </form>
<br>
<p><a href="{% url 'store:delete-cart' %}" class="btn btn-danger">Supprimer le panier</a></p>

{% endblock %}